<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>NA • SamsaRaLight</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="NA"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">SamsaRaLight</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/1-minimal_case.html">1 - A first minimal case</a></li>
    <li><a class="dropdown-item" href="articles/2-ray_tracing.html">2 - Ray discretisation</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>NA</h1>

    </div>


<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a></h2>
<p>The SamsaRaLight R package (Figure 1) has been designed to make the SamsaraLight ray-tracing model [@courbaud_simulating_2003] simpler and faster to use directly in the R programming environment. It allows users to estimate the energy absorbed by each tree in a given forest over a specified period, and consequently the energy reaching the forest floor. To achieve this, the package allows users to create a 3D model of their tree inventory, representing individual crowns with various symmetric or asymmetric geometric shapes, and the forest stand with a specified size, slope, and aspect. The package then discretises direct and diffuse light rays with different orientations, angles and incident energies, depending on the forest’s latitude and longitude. These rays are then cast towards a grid of points within the forest stand. This makes it possible to compute the attenuation of energy throughout successive tree crowns in the forest canopy and derive energies and light competition variables at tree or ground level.</p>
<div class="float">
<img src="paper/figures/fig_global.jpg" alt="Global aim of the SamsaRaLight R package"><div class="figcaption">Global aim of the SamsaRaLight R package</div>
</div>
</div>
<div class="section level2">
<h2 id="statement-of-need">Statement of need<a class="anchor" aria-label="anchor" href="#statement-of-need"></a></h2>
<div class="section level3">
<h3 id="the-use-of-ray-tracing-models-to-better-understand-tree-and-saplings-dynamics"><em>The use of ray-tracing models to better understand tree and saplings dynamics</em><a class="anchor" aria-label="anchor" href="#the-use-of-ray-tracing-models-to-better-understand-tree-and-saplings-dynamics"></a></h3>
<p>Light is a major resource that influences the dynamics of both saplings and trees [@binkley_light_2013], leading to plasticity in crown dimensions in response to this frantic competition [@touzot_shade_2025]. To better understand the effects of light competition in forests, numerous forest radiative transfer models have been developed and improved over the years. These models differ in the complexity with which they represent the canopy, how they describe light, and how they calculate the absorption of light by crowns [@ligot_forest_2014]. A particular characteristic of light competition is its asymmetry due to the attenuation of light rays across the canopy [@weiner_asymmetric_1990, @schwinning_mechanisms_1998], which has led to the development of ray-tracing models. One widely used and recognised model in forest modelling is the SamsaraLight ray-tracing model, developed by Courbaud et al. [-@courbaud_simulating_2003].</p>
<p>The SamsaraLight model has been used to derive light competition indices to fit tree-based growth and mortality models. For example, Beauchamp et al. [-@beauchamp_light_2025] examined the interaction effect between light competition and climate on tree growth and mortality for 33 European trees species from Spain to Scandinavia. The SamsaraLight model has also been used to estimate light reaching the forest floor, enabling to better understand the regeneration dynamics For example, Ligot et al. [-@ligot_managing_2014] observed how different cutting strategies modified light availability under the post-harvest canopy, and how it could promote the regeneration of mixtures of species of different shade tolerances. (Ici mettre [@ligot_tree_2016] for effect of stand structure on light transmittance)</p>
</div>
<div class="section level3">
<h3 id="implementation-in-simulators-to-better-grasp-forest-structure-and-demographic-processes"><em>Implementation in simulators to better grasp forest structure and demographic processes</em><a class="anchor" aria-label="anchor" href="#implementation-in-simulators-to-better-grasp-forest-structure-and-demographic-processes"></a></h3>
<p>The SamsaraLight model was originally used as a library within the Capsis platform, a JAVA software that implements forest simulators [@dufour-kowalski_capsis_2012]. While the SamsaraLight model has long been used in Capsis as a component of more complex forest models, it appeared to be difficult to use the model independently of the CAPSIS platform. Following the increasing use of the R programming language in biology, Fortin et al. developed the R packages J4R and RCapsis [@fortin_executing_2020]. RCapsis enables models and simulators developed in the Capsis platform to be called by R scripts using J4R to manipulate Java objects to be directly in R. The SamsaraLight model has been implemented as a sub-model in many Capsis forest simulators to consider the effect of light competition on stand structure and dynamics, for example Samsara2 [@courbaud_applying_2015], PDG-ARENA [@rouet_pdg-arena_2025], HETEROFOR 1.0 [@jonard_heterofor_2020, @de_wergifosse_heterofor_2020] or RReShar [@barrere_oak_2024].</p>
<p>Incorporating light competition into forest simulations enables a more accurate assessment of the impact of silvicultural interventions on forest dynamics [@lafond_uneven-aged_2014].</p>
</div>
<div class="section level3">
<h3 id="simplify-and-broaden-the-use-of-the-model-with-the-samsaralight-r-package"><em>Simplify and broaden the use of the model with the SamsaRaLight R package</em><a class="anchor" aria-label="anchor" href="#simplify-and-broaden-the-use-of-the-model-with-the-samsaralight-r-package"></a></h3>
<p>These modelling objectives are very general and are pursued by researchers who do not use Capsis. In addition, model fitting and analysing simulations require the use of statistical software, and R has become nowadays an essential tool. Some forest simulators have now been totally implemented in a simplified version in R (<em>e.g.</em> SurEau-Ecos; [@ruffault_sureau-ecos_2022]). However, calculating the radiative balance using a ray-tracing approach is time- and memory-consuming. It is therefore important to optimise the use of this type of algorithm by avoiding juggling with intermediate files, external programs and different programming languages. Using the <em>SamsaRaLight</em> R package could simplify the explicit consideration of light competition and transmission for further studies on tree and regeneration dynamics and the use of the SamsaraLight ray-tracing model in forest simulators for non-Capsis users.</p>
<p>The development of the <em>SamsaRaLight</em> R package could open new perspectives by linking it to other modern technologies. With the increasing development of Lidar technologies in forest modelling for data collection [@lines_shape_2022], the computation of light interception with the SamsaRaLight R package could be linked to Lidar-based R packages, such as ITSMe [@terryn_analysing_2023] that describe tree crown volume based on close-range LiDAR scanning, or LidaRtRee [@monnet_lidartree_2025] for forest analysing based on Airborne Laser Scanning.</p>
<p>Finally, we hope that the <em>SamsaRaLight</em> R package could broaden the use of ray-tracing models outside of forest modelling, for example in agroforestry, where the ray-tracing model is used to consider the shading effect of tree-lines lines in lowering crop growth across a field [@dupraz_hi-safe_2019].</p>
</div>
</div>
<div class="section level2">
<h2 id="key-features">Key features<a class="anchor" aria-label="anchor" href="#key-features"></a></h2>
<div class="section level3">
<h3 id="simple-use-in-the-r-environment-with-functions-to-facilitate-pre--and-post--treatment"><em>Simple use in the R environment with functions to facilitate pre- and post- treatment</em><a class="anchor" aria-label="anchor" href="#simple-use-in-the-r-environment-with-functions-to-facilitate-pre--and-post--treatment"></a></h3>
<p>The <em>SamsaRaLight</em> R package enables the SamsaraLight ray-tracing model to be used directly and totally in an R script. The description of the forest stand and the radiation data are carried out by constructing a formatted R data frame. R functions are implemented to facilitate the construction of the virtual stand based on the user input tree inventory and the definition of monthly radiations based on the stand location by fetching the monthly global energy and ratio of diffuse to global radiations from the European PVGIS database [@huld_new_2012]. The SamsaraLight model run with default arguments that can be optionally adjusted to control the ray tracing model parameters and internal behaviour. Finally, base r functions (print(), summary() and plot()) allows visualizing both the input stand and the output light variables with tree maps using the ggplot2 package [@wickham_ggplot2_2016].</p>
</div>
<div class="section level3">
<h3 id="fast-computation-time-with-a-c-background-implementation-and-parallelisation-using-openmp"><em>Fast computation time with a C++ background implementation and parallelisation using OpenMP</em><a class="anchor" aria-label="anchor" href="#fast-computation-time-with-a-c-background-implementation-and-parallelisation-using-openmp"></a></h3>
<p>The <em>SamsaraLight</em> R package enables the SamsaraLight model to be run much faster than previous methods. We wrote the core code of the model in the C++ programming language and communicate with the R programming language using the R/C++ package Rcpp [@eddelbuettel_rcpp_2025]. This allows us to take advantage of the increased computational performance and memory management of C++, as well as the increased flexibility offered to users by the R language. We also allowed to run ray-tracing in parallel with fine control over the number of used cores and a functionnality to desactivate/activate it, using shared-memory parallel jobs with OpenMP.</p>
</div>
<div class="section level3">
<h3 id="easy-learning-with-online-documentation-and-tutorials"><em>Easy learning with online documentation and tutorials</em><a class="anchor" aria-label="anchor" href="#easy-learning-with-online-documentation-and-tutorials"></a></h3>
<p>The <em>SamsaRaLight</em> R package is associated with an online documentation based on the R package pkgdown [@wickham_pkgdown_2025], stored in the following webpage: <a href="https://natheob.github.io/SamsaRaLight/" class="uri">https://natheob.github.io/SamsaRaLight/</a>. Herein, we provide a more detailed description of the SamsaraLight model associated to several vignettes in the form of progressive tutorials to help users learn how to use the package based on the real forest data included within the package.</p>
</div>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a></h2>
<p>The SamsaraLight model has been initially designed by Benoit Courbaud and implemented in Capsis by François de Coligny. SamsaraLight has been next updated with new functionality or upgraded for faster computation time by various persons across years.</p>
</div>


  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Natheo Beauchamp, Gauthier Ligot, Francois de Coligny, Maxime Jaunatre, Benoit Courbaud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

