% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/run_sl_advanced.R
\name{run_sl_advanced}
\alias{run_sl_advanced}
\title{Compute advanced SamsaRaLight radiative balance}
\usage{
run_sl_advanced(
  sl_stand,
  monthly_radiations,
  sensors_only = FALSE,
  use_torus = TRUE,
  turbid_medium = TRUE,
  extinction_coef = 0.5,
  clumping_factor = 1,
  trunk_interception = TRUE,
  height_anglemin = 10,
  direct_startoffset = 0,
  direct_anglestep = 5,
  diffuse_anglestep = 15,
  soc = TRUE,
  start_day = 1,
  end_day = 365,
  detailed_output = FALSE,
  parallel_mode = FALSE,
  n_threads = NULL,
  verbose = TRUE
)
}
\arguments{
\item{sl_stand}{An object of class \code{"sl_stand"} representing the virtual stand.
Each row is a tree with required and optional columns describing crown geometry,
height, crown radius, crown openness, LAD, etc. See \link{validate_sl_stand}.}

\item{monthly_radiations}{data.frame of monthly horizontal radiation (Hrad) and
diffuse to global ratio (DGratio), computed with \link{get_monthly_radiations}.}

\item{sensors_only}{logical, if TRUE, compute interception only for sensors}

\item{use_torus}{logical, if TRUE, use torus system for borders, else open grassland}

\item{turbid_medium}{logical, if TRUE, crowns are considered turbid medium, else porous envelope}

\item{extinction_coef}{Numeric scalar. Leaf extinction coefficient controlling
the probability that a ray is intercepted by foliage. It represents the
effective light attenuation per unit leaf area and is linked to average
leaf orientation. Higher values increase interception (default = 0.5).}

\item{clumping_factor}{Numeric scalar controlling the aggregation of leaves
within the crown volume. A value of 1 corresponds to a homogeneous (random)
foliage distribution; values < 1 indicate clumped foliage, and values > 1
indicate more regular spacing. This modifies effective light interception
in the turbid medium model (default = 1).}

\item{trunk_interception}{logical, if TRUE, account for trunk interception}

\item{height_anglemin}{numeric, minimum altitude angle for rays (degrees)}

\item{direct_startoffset}{numeric, starting angle of first direct ray (degrees)}

\item{direct_anglestep}{numeric, hour angle step between direct rays (degrees)}

\item{diffuse_anglestep}{numeric, hour angle step between diffuse rays (degrees)}

\item{soc}{logical, if TRUE, use Standard Overcast Sky; if FALSE, Uniform Overcast Sky}

\item{start_day}{integer, first day of the vegetative period (1–365)}

\item{end_day}{integer, last day of the vegetative period (1–365)}

\item{detailed_output}{logical, if TRUE, include detailed rays, energies, and interception matrices}

\item{parallel_mode}{logical. If TRUE, ray–target computations are parallelised
using OpenMP. If FALSE, the model runs in single-thread mode.}

\item{n_threads}{integer or NULL. Number of CPU threads to use when
\code{parallel_mode = TRUE}. If NULL (default), OpenMP automatically selects
the number of available cores. If provided, must be a positive integer.}

\item{verbose}{Logical; if \code{TRUE}, informative messages are printed.}
}
\value{
An object of class \code{"sl_output"} (list) containing:
\itemize{
\item \code{light}: list with simulation outputs for trees, cells, and sensors
\item \code{info}: list with run metadata (latitude, days, sky type, etc.)
\item \code{monthly_rays} (if detailed_output = TRUE): ray discretization per month
\item \code{interceptions} (if detailed_output = TRUE): tree/cell interception matrices
}
}
\description{
This function runs the full light interception and radiative balance
simulation for a virtual forest stand with advanced parameters. It allows
customization of ray discretization, sky type and trunk interception.
}
\details{
For typical use, see the simpler \link{run_sl} wrapper that sets standard
discretization parameters for most users.

This advanced function exposes all ray tracing parameters and is intended
for users who need full control over ray discretization and modeling options.
For most users, see \link{run_sl} which wraps this function with default
parameters suitable for standard runs.
}
\keyword{internal}
