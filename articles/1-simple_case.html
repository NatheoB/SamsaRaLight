<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>1 - A first simple case • SamsaRaLight</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="1 - A first simple case">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SamsaRaLight</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/1-simple_case.html">1 - A first simple case</a></li>
    <li><a class="dropdown-item" href="../articles/2-stand_geometry.html">2 - Understand stand information</a></li>
    <li><a class="dropdown-item" href="../articles/3-transmission_model.html">3 - Choose the transmission model</a></li>
    <li><a class="dropdown-item" href="../articles/4-core_polygon.html">4 - Create a virtual stand from an inventory</a></li>
    <li><a class="dropdown-item" href="../articles/5-irregular_crowns.html">5 - More complex crown shapes</a></li>
    <li><a class="dropdown-item" href="../articles/7-light_sensors.html">7 - Add light sensors</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>1 - A first simple case</h1>
            <h3 data-toc-skip class="subtitle">Compute tree light
interception by symmetric crowns in an axis-aligned rectangle plot</h3>
            
      

      <div class="d-none name"><code>1-simple_case.Rmd</code></div>
    </div>

    
    
<p>This is a first tutorial which shows you how to solve a basic problem
with the SamsaRaLight package. We will exemplify this simple case with
the Prenovel dataset stored in the package as
<code><a href="../reference/data_prenovel.html">SamsaRaLight::data_prenovel</a></code>. It is an uneven-aged stand of
fir-spruce-beech located in the Jura mountains (France). Get more
information in the data documentation.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://natheob.github.io/SamsaRaLight/">SamsaRaLight</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h2>
<div class="section level3">
<h3 id="virtual-stand-geometry">Virtual stand geometry<a class="anchor" aria-label="anchor" href="#virtual-stand-geometry"></a>
</h3>
<p>SamsaRaLight needs to be run on a axis-aligned rectangle stand that
is split into square identical cells. This rectangle stand can have a
given homogeneous slope with a given orientation and aspect. Finally, as
the radiation depends on the plot location, the user needs to precise
the latitude/longitude coordinates of the stand. If the virtual stand is
not represented as a axis-aligned rectangle, the user can also refer to
the Tutorial 4 (4 - Create a virtual stand from tree inventory).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Information of the plot are given here</span></span>
<span><span class="va">infos</span> <span class="op">&lt;-</span> <span class="fu">SamsaRaLight</span><span class="fu">::</span><span class="va"><a href="../reference/data_prenovel.html">data_prenovel</a></span><span class="op">$</span><span class="va">info</span></span>
<span><span class="va">infos</span></span>
<span><span class="co">#&gt;      latitude     longitude        size_x        size_y         slope </span></span>
<span><span class="co">#&gt;      46.52666       5.82765     100.00000     100.00000       6.00000 </span></span>
<span><span class="co">#&gt;        aspect north_to_x_cw </span></span>
<span><span class="co">#&gt;     144.00000      54.00000</span></span>
<span></span>
<span><span class="co"># Coordinates of the stand (for monthly radiation and rays geometry)</span></span>
<span><span class="va">latitude</span> <span class="op">&lt;-</span> <span class="va">infos</span><span class="op">[[</span><span class="st">"latitude"</span><span class="op">]</span><span class="op">]</span> <span class="co"># The latitude of the stand (Y-coord in WGS85)</span></span>
<span><span class="va">longitude</span> <span class="op">&lt;-</span> <span class="va">infos</span><span class="op">[[</span><span class="st">"longitude"</span><span class="op">]</span><span class="op">]</span> <span class="co"># The longitude of the plot (X-coord in WGS85)</span></span>
<span></span>
<span><span class="co"># The slope of the stand</span></span>
<span><span class="va">slope</span> <span class="op">&lt;-</span> <span class="va">infos</span><span class="op">[[</span><span class="st">"slope"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Angle of slope bottom on the compass from the North, clockwise rotation (in degrees)</span></span>
<span><span class="co"># northern aspect : 0, eastern aspect : 90, southern aspect : 180, western aspect : 270</span></span>
<span><span class="va">aspect</span> <span class="op">&lt;-</span> <span class="va">infos</span><span class="op">[[</span><span class="st">"aspect"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Angle from North to x axis clockwise. (in degrees)</span></span>
<span><span class="co"># Default correspond to a Y axis oriented toward the North.</span></span>
<span><span class="va">north_to_x_cw</span> <span class="op">&lt;-</span> <span class="va">infos</span><span class="op">[[</span><span class="st">"north_to_x_cw"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Considering a squared plot, number and size of the cells composing the grid</span></span>
<span><span class="va">cell_size</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># Size of the length of a cell</span></span>
<span><span class="va">n_cells_x</span> <span class="op">&lt;-</span> <span class="va">infos</span><span class="op">[[</span><span class="st">"size_x"</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="va">cell_size</span> <span class="co"># Number of cells columns</span></span>
<span><span class="va">n_cells_y</span> <span class="op">&lt;-</span> <span class="va">infos</span><span class="op">[[</span><span class="st">"size_y"</span><span class="op">]</span><span class="op">]</span> <span class="op">/</span> <span class="va">cell_size</span> <span class="co"># Number of cells rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="trees-description">Trees description<a class="anchor" aria-label="anchor" href="#trees-description"></a>
</h3>
<p>The user needs to define the trees composing the stand with their
crown dimensions. The data frame must be created with a specific format
and variables: see documentation using ?SamsaRaLight::sl_run to
understand the composition of the trees dataset.</p>
<p>The dataframe must contain mandatory information about the trees: a
unique integer id (id_tree), the species name (species), coordinates (x,
y) and diameter at breast height in cm (dbh_cm). The x and y coordinates
must be given relatively to the rectangle plot as defined above (thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>c</mi><mi>e</mi><mi>l</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>*</mo><mi>n</mi><mi>c</mi><mi>e</mi><mi>l</mi><mi>l</mi><msub><mi>s</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">0 \le x \le cellsize * ncells_x</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>y</mi><mo>≤</mo><mi>c</mi><mi>e</mi><mi>l</mi><mi>l</mi><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi><mo>*</mo><mi>n</mi><mi>c</mi><mi>e</mi><mi>l</mi><mi>l</mi><msub><mi>s</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">0 \le y \le cellsize * ncells_y</annotation></semantics></math>)
and are given on a flat plane, not considering slope. The z coordinate
is computed automatically during the process.</p>
<p>In this tutorial, we represent the tree crowns with simple shapes,
defined in the crown_type column by a specific code: “E” (for an
ellipsoid) or “P” (for a paraboloid). The ellipsoidal shape “E” is
commonly used for broadleaved species, whereas a paraboloidal shape “P”
is commonly used for conifers. When using simple crown shapes, the user
must provide only 3 values to define the crown dimensions: the height of
the tree (h_m in meters), the height of the crown base (hbase_m in
meters) and the crown maximum radius that is the same is the four
cardinal directions as we wonsider simple symetric crowns (rn_m, re_m,
rs_m and rw_m, all in meters). When considering those type of simple
crown shapes (“E” or “P”), the user must not provide the hmax_m
variable, which is the height at which the crown radius is maximum.
Indeed, it is automatically computed during the process, being set to
the crown base height
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>=</mo><mi>h</mi><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">hmax = hbase</annotation></semantics></math>)
when considering a paraboloidal shape “P”, and set at the middle of the
crown for an ellipsoidal shape “E”
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo>=</mo><mi>h</mi><mo>−</mo><mn>0.5</mn><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mo>−</mo><mi>h</mi><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">hmax = h - 0.5*(h - hbase)</annotation></semantics></math>).</p>
<p>In the next tutorials, we will explain more in details the columns
crown_openess/crown_lad (3 - Consider crowns as either a porous envelop
or a turbid medium) and consider more complex asymetric crown shapes (5
- Represent the crowns with more complex shapes).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_trees</span> <span class="op">&lt;-</span> <span class="fu">SamsaRaLight</span><span class="fu">::</span><span class="va"><a href="../reference/data_prenovel.html">data_prenovel</a></span><span class="op">$</span><span class="va">trees</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data_trees</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id_tree    species       x       y  dbh_cm crown_type     h_m hbase_m hmax_m</span></span>
<span><span class="co">#&gt; 1       1 Abies alba 77.7336 71.0808 22.9320          P 14.8120  3.3073     NA</span></span>
<span><span class="co">#&gt; 2       2 Abies alba 62.5783 65.1864 18.2397          P 12.9612  4.7429     NA</span></span>
<span><span class="co">#&gt; 3       3 Abies alba 84.0060 95.2483 22.8472          P 15.8187  4.9055     NA</span></span>
<span><span class="co">#&gt; 4       4 Abies alba 58.9521 97.9011 19.1539          P 11.7033  4.2050     NA</span></span>
<span><span class="co">#&gt; 5       5 Abies alba 33.3423 39.4053 19.8852          P 14.6597  3.8346     NA</span></span>
<span><span class="co">#&gt; 6       6 Abies alba 57.5743  2.0656 20.1293          P 16.6530  7.6860     NA</span></span>
<span><span class="co">#&gt;     rn_m   re_m   rs_m   rw_m crown_openess crown_lad</span></span>
<span><span class="co">#&gt; 1 3.0204 3.0204 3.0204 3.0204           0.2     0.767</span></span>
<span><span class="co">#&gt; 2 3.0896 3.0896 3.0896 3.0896           0.2     0.767</span></span>
<span><span class="co">#&gt; 3 2.8350 2.8350 2.8350 2.8350           0.2     0.767</span></span>
<span><span class="co">#&gt; 4 2.5196 2.5196 2.5196 2.5196           0.2     0.767</span></span>
<span><span class="co">#&gt; 5 2.8208 2.8208 2.8208 2.8208           0.2     0.767</span></span>
<span><span class="co">#&gt; 6 3.2436 3.2436 3.2436 3.2436           0.2     0.767</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="monthly-radiations">Monthly radiations<a class="anchor" aria-label="anchor" href="#monthly-radiations"></a>
</h3>
<p>The user needs to define in a data frame the monthly energy specific
to its plot location. For each month (represented by an integer number
between 1 and 12), one needs to inform
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mi>r</mi><mi>a</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">Hrad</annotation></semantics></math>
as the global monthly energies (in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mi>J</mi><mi>.</mi><msup><mi>m</mi><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">MJ.m^{-2}</annotation></semantics></math>),
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>G</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi></mrow><annotation encoding="application/x-tex">DGratio</annotation></semantics></math>
as the ratio of diffuse energy relative to global energy (needed to
represent the proportion of diffuse and direct energy).</p>
<p>This data frame can be automatically constructed using the
SamsaRaLight function <code><a href="../reference/get_monthly_rad.html">SamsaRaLight::get_monthly_rad()</a></code>,
given the latitude and longitude of the plot. It gets radiation data
from the PVGIS European database (needs an Internet connection).</p>
<p>Otherwise, the monthly radiation data frame used in this tutorial
(Prenovel stand) is stored within the package and can be retrieved using
<code>SamsaRaLight::data_prenovel$radiations</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the monthly radiation data frame</span></span>
<span><span class="va">data_monthly_rad</span> <span class="op">&lt;-</span> <span class="fu">SamsaRaLight</span><span class="fu">::</span><span class="fu"><a href="../reference/get_monthly_rad.html">get_monthly_rad</a></span><span class="op">(</span><span class="va">latitude</span>, <span class="va">longitude</span><span class="op">)</span></span>
<span><span class="va">data_monthly_rad</span></span>
<span><span class="co">#&gt;    month     Hrad  DGratio</span></span>
<span><span class="co">#&gt; 1      1 137.0902 0.580625</span></span>
<span><span class="co">#&gt; 2      2 206.3025 0.506875</span></span>
<span><span class="co">#&gt; 3      3 353.8260 0.493125</span></span>
<span><span class="co">#&gt; 4      4 465.8220 0.490000</span></span>
<span><span class="co">#&gt; 5      5 535.2458 0.508750</span></span>
<span><span class="co">#&gt; 6      6 618.1785 0.463750</span></span>
<span><span class="co">#&gt; 7      7 655.1730 0.425000</span></span>
<span><span class="co">#&gt; 8      8 557.6332 0.436250</span></span>
<span><span class="co">#&gt; 9      9 423.9382 0.446875</span></span>
<span><span class="co">#&gt; 10    10 280.2780 0.475000</span></span>
<span><span class="co">#&gt; 11    11 157.9635 0.538750</span></span>
<span><span class="co">#&gt; 12    12 116.4960 0.587500</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="run-samsaralight">Run SamsaRaLight<a class="anchor" aria-label="anchor" href="#run-samsaralight"></a>
</h2>
<p>Now, given the stand geometry, the trees dataset and the monthly
radiation, you can easily run the SamsaraLight ray-tracing model using
the function <code><a href="../reference/sl_run.html">sl_run()</a></code>. Note that the computation time
increase exponentially with the cell size decreasing.</p>
<p>The other function arguments are addressed throughout the next
tutorials, and especially at the last one (8 - Deeper understanding of
the SamsaraLight parameters).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sl_output</span> <span class="op">&lt;-</span> <span class="fu">SamsaRaLight</span><span class="fu">::</span><span class="fu"><a href="../reference/sl_run.html">sl_run</a></span><span class="op">(</span></span>
<span>    <span class="co"># Trees</span></span>
<span>    trees <span class="op">=</span> <span class="va">data_trees</span>, </span>
<span>    </span>
<span>    <span class="co"># Radiations</span></span>
<span>    monthly_rad <span class="op">=</span> <span class="va">data_monthly_rad</span>,</span>
<span>    latitude <span class="op">=</span> <span class="va">latitude</span>, </span>
<span>    </span>
<span>    <span class="co"># Stand geometry</span></span>
<span>    slope <span class="op">=</span> <span class="va">slope</span>, </span>
<span>    aspect <span class="op">=</span> <span class="va">aspect</span>, </span>
<span>    north_to_x_cw <span class="op">=</span> <span class="va">north_to_x_cw</span>,</span>
<span>    cell_size <span class="op">=</span> <span class="va">cell_size</span>, </span>
<span>    n_cells_x <span class="op">=</span> <span class="va">n_cells_x</span>, </span>
<span>    n_cells_y <span class="op">=</span> <span class="va">n_cells_y</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a>
</h2>
<div class="section level3">
<h3 id="plot-the-virtual-stand">Plot the virtual stand<a class="anchor" aria-label="anchor" href="#plot-the-virtual-stand"></a>
</h3>
<p>The user can first observe its virtual stand using the function
<code><a href="../reference/plot_sl_output.html">plot_sl_output()</a></code> directly on the output object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_sl_output.html">plot_sl_output</a></span><span class="op">(</span><span class="va">sl_output</span><span class="op">)</span></span></code></pre></div>
<p><img src="1-simple_case_files/figure-html/plot_stand-1.png" width="768"></p>
</div>
<div class="section level3">
<h3 id="output-format">Output format<a class="anchor" aria-label="anchor" href="#output-format"></a>
</h3>
<p>The output is a complex R object, with first a list of three
elements: <code>$input</code> (that gathers inputs of the model defined
above), <code>$monthly_rays</code> containing the rays that are cast
toward each cell and <code>$output</code> (containing the output of the
SamsaraLight ray-tracing model).</p>
<p>Here, we will focus on the outputs of the model for the cells
<code>$output$cells</code> and the trees <code>$output$trees</code>. The
output for the sensors <code>$output$sensors</code> are explained in the
Tutorial 7 (7 - Estimate light on virtual sensors) and the
<code>$monthly_rays</code> are addressed in the next tutorial (2 -
Importance of stand latitude, slope and orientation).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">sl_output</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ input       :List of 3</span></span>
<span><span class="co">#&gt;   ..$ trees      :'data.frame':  333 obs. of  15 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ id_tree      : int [1:333] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;   .. ..$ species      : chr [1:333] "Abies alba" "Abies alba" "Abies alba" "Abies alba" ...</span></span>
<span><span class="co">#&gt;   .. ..$ x            : num [1:333] 77.7 62.6 84 59 33.3 ...</span></span>
<span><span class="co">#&gt;   .. ..$ y            : num [1:333] 71.1 65.2 95.2 97.9 39.4 ...</span></span>
<span><span class="co">#&gt;   .. ..$ dbh_cm       : num [1:333] 22.9 18.2 22.8 19.2 19.9 ...</span></span>
<span><span class="co">#&gt;   .. ..$ crown_type   : chr [1:333] "P" "P" "P" "P" ...</span></span>
<span><span class="co">#&gt;   .. ..$ h_m          : num [1:333] 14.8 13 15.8 11.7 14.7 ...</span></span>
<span><span class="co">#&gt;   .. ..$ hbase_m      : num [1:333] 3.31 4.74 4.91 4.21 3.83 ...</span></span>
<span><span class="co">#&gt;   .. ..$ hmax_m       : logi [1:333] NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;   .. ..$ rn_m         : num [1:333] 3.02 3.09 2.83 2.52 2.82 ...</span></span>
<span><span class="co">#&gt;   .. ..$ re_m         : num [1:333] 3.02 3.09 2.83 2.52 2.82 ...</span></span>
<span><span class="co">#&gt;   .. ..$ rs_m         : num [1:333] 3.02 3.09 2.83 2.52 2.82 ...</span></span>
<span><span class="co">#&gt;   .. ..$ rw_m         : num [1:333] 3.02 3.09 2.83 2.52 2.82 ...</span></span>
<span><span class="co">#&gt;   .. ..$ crown_openess: num [1:333] 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 0.2 ...</span></span>
<span><span class="co">#&gt;   .. ..$ crown_lad    : num [1:333] 0.767 0.767 0.767 0.767 0.767 0.767 0.767 0.767 0.767 0.767 ...</span></span>
<span><span class="co">#&gt;   ..$ monthly_rad:'data.frame':  12 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ month  : int [1:12] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;   .. ..$ Hrad   : num [1:12] 137 206 354 466 535 ...</span></span>
<span><span class="co">#&gt;   .. ..$ DGratio: num [1:12] 0.581 0.507 0.493 0.49 0.509 ...</span></span>
<span><span class="co">#&gt;   ..$ info       :List of 17</span></span>
<span><span class="co">#&gt;   .. ..$ latitude          : num 46.5</span></span>
<span><span class="co">#&gt;   .. ..$ start_day         : num 1</span></span>
<span><span class="co">#&gt;   .. ..$ end_day           : num 365</span></span>
<span><span class="co">#&gt;   .. ..$ slope             : num 6</span></span>
<span><span class="co">#&gt;   .. ..$ north_to_x_cw     : num 54</span></span>
<span><span class="co">#&gt;   .. ..$ aspect            : num 144</span></span>
<span><span class="co">#&gt;   .. ..$ cell_size         : num 1</span></span>
<span><span class="co">#&gt;   .. ..$ n_cells_x         : num 100</span></span>
<span><span class="co">#&gt;   .. ..$ n_cells_y         : num 100</span></span>
<span><span class="co">#&gt;   .. ..$ soc               : logi TRUE</span></span>
<span><span class="co">#&gt;   .. ..$ height_anglemin   : num 10</span></span>
<span><span class="co">#&gt;   .. ..$ direct_startoffset: num 0</span></span>
<span><span class="co">#&gt;   .. ..$ direct_anglestep  : num 5</span></span>
<span><span class="co">#&gt;   .. ..$ diffuse_anglestep : num 15</span></span>
<span><span class="co">#&gt;   .. ..$ use_torus         : logi TRUE</span></span>
<span><span class="co">#&gt;   .. ..$ turbid_medium     : logi TRUE</span></span>
<span><span class="co">#&gt;   .. ..$ trunk_interception: logi TRUE</span></span>
<span><span class="co">#&gt;  $ monthly_rays:List of 2</span></span>
<span><span class="co">#&gt;   ..$ energies: Named num [1:4] 2440 2095 2289 2061</span></span>
<span><span class="co">#&gt;   .. ..- attr(*, "names")= chr [1:4] "slope_direct" "slope_diffuse" "horizontal_direct" "horizontal_diffuse"</span></span>
<span><span class="co">#&gt;   ..$ rays    :'data.frame': 491 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ id_ray      : int [1:491] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;   .. ..$ azimut      : num [1:491] 4.96 4.9 4.82 4.75 4.67 ...</span></span>
<span><span class="co">#&gt;   .. ..$ height_angle: num [1:491] 0.111 0.156 0.198 0.237 0.273 ...</span></span>
<span><span class="co">#&gt;   .. ..$ e_incident  : num [1:491] 8.62 8.62 8.62 8.62 8.62 ...</span></span>
<span><span class="co">#&gt;   .. ..$ direct      : logi [1:491] TRUE TRUE TRUE TRUE TRUE TRUE ...</span></span>
<span><span class="co">#&gt;  $ output      :List of 3</span></span>
<span><span class="co">#&gt;   ..$ sensors:'data.frame':  0 obs. of  7 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ id_sensor: int(0) </span></span>
<span><span class="co">#&gt;   .. ..$ x        : num(0) </span></span>
<span><span class="co">#&gt;   .. ..$ y        : num(0) </span></span>
<span><span class="co">#&gt;   .. ..$ z        : num(0) </span></span>
<span><span class="co">#&gt;   .. ..$ e        : num(0) </span></span>
<span><span class="co">#&gt;   .. ..$ pacl     : num(0) </span></span>
<span><span class="co">#&gt;   .. ..$ punobs   : num(0) </span></span>
<span><span class="co">#&gt;   ..$ trees  :'data.frame':  333 obs. of  8 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ id_tree: int [1:333] 116 92 46 273 176 4 272 157 89 29 ...</span></span>
<span><span class="co">#&gt;   .. ..$ x      : num [1:333] 13.4 43.1 72.8 93.7 44.9 ...</span></span>
<span><span class="co">#&gt;   .. ..$ y      : num [1:333] 99.2 98 98 98.1 97.3 ...</span></span>
<span><span class="co">#&gt;   .. ..$ z      : num [1:333] 10.4 10.3 10.3 10.3 10.2 ...</span></span>
<span><span class="co">#&gt;   .. ..$ epot   : num [1:333] 387315 253854 203115 76454 221087 ...</span></span>
<span><span class="co">#&gt;   .. ..$ e      : num [1:333] 115800 96237 56294 15399 9713 ...</span></span>
<span><span class="co">#&gt;   .. ..$ lci    : num [1:333] 0.606 0.686 0.672 0.803 0.959 ...</span></span>
<span><span class="co">#&gt;   .. ..$ eunobs : num [1:333] 83985 81000 45459 10109 1318 ...</span></span>
<span><span class="co">#&gt;   ..$ cells  :'data.frame':  10000 obs. of  7 variables:</span></span>
<span><span class="co">#&gt;   .. ..$ id_cell : int [1:10000] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;   .. ..$ x_center: num [1:10000] 0.5 1.5 2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5 ...</span></span>
<span><span class="co">#&gt;   .. ..$ y_center: num [1:10000] 99.5 99.5 99.5 99.5 99.5 99.5 99.5 99.5 99.5 99.5 ...</span></span>
<span><span class="co">#&gt;   .. ..$ z_center: num [1:10000] 10.5 10.5 10.5 10.5 10.5 ...</span></span>
<span><span class="co">#&gt;   .. ..$ e       : num [1:10000] 480 534 524 508 490 ...</span></span>
<span><span class="co">#&gt;   .. ..$ pacl    : num [1:10000] 0.105 0.117 0.115 0.111 0.107 ...</span></span>
<span><span class="co">#&gt;   .. ..$ punobs  : num [1:10000] 0.308 0.377 0.473 0.406 0.329 ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="understand-the-output-cells-and-trees-samsaralight-variables">Understand the output cells and trees SamsaraLight variables<a class="anchor" aria-label="anchor" href="#understand-the-output-cells-and-trees-samsaralight-variables"></a>
</h3>
<div class="section level4">
<h4 id="output-cell">Output cell<a class="anchor" aria-label="anchor" href="#output-cell"></a>
</h4>
<p>The object <code>$output$cells</code> contains output light variables
for each cell, identified by its unique id (id_cell) and the coordinates
of the cell center (x_center, y_center, z_center). There are 3 output
variables, which are <code>e</code> (for the energy arriving on the cell
in MJ), <code>pacl</code> (for proportion of above light canopy, which
is the ratio between the energy arriving on the cell and the energy
before interception by the trees) and <code>punobs</code> (for the
proportion of energy on the cell that comes from unobstructed rays,
i.e. rays that have not been intercepted by any trees).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sl_output</span><span class="op">$</span><span class="va">output</span><span class="op">$</span><span class="va">cells</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id_cell x_center y_center z_center        e      pacl    punobs</span></span>
<span><span class="co">#&gt; 1       1      0.5     99.5 10.45787 480.1922 0.1053010 0.3077038</span></span>
<span><span class="co">#&gt; 2       2      1.5     99.5 10.45787 534.4402 0.1171970 0.3767941</span></span>
<span><span class="co">#&gt; 3       3      2.5     99.5 10.45787 524.3878 0.1149927 0.4734174</span></span>
<span><span class="co">#&gt; 4       4      3.5     99.5 10.45787 507.7187 0.1113373 0.4059686</span></span>
<span><span class="co">#&gt; 5       5      4.5     99.5 10.45787 490.2187 0.1074998 0.3291288</span></span>
<span><span class="co">#&gt; 6       6      5.5     99.5 10.45787 486.8014 0.1067504 0.2460796</span></span></code></pre></div>
<p>The user can plot a given output variable (e.g. cells.fill = “e” or
cells.fill = “pacl) without the trees above (trees.fill = NULL) to
observe the light distribution within the stand (absolute or relative to
the above light). Aesthetic arguments can be tweaked, such as the cell
borders (cell.borders = FALSE) or the palette used for filling the cells
(e.g. cells.fill.palette =”light” or cells.fill.palette = “light01” for
forcing the limits of the palette between 0 and 1).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_sl_output.html">plot_sl_output</a></span><span class="op">(</span><span class="va">sl_output</span>,</span>
<span>               trees.fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               cells.fill <span class="op">=</span> <span class="st">"e"</span>,</span>
<span>               cells.fill.palette <span class="op">=</span> <span class="st">"light"</span>,</span>
<span>               cells.border <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="1-simple_case_files/figure-html/plot_ecell-1.png" width="768"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_sl_output.html">plot_sl_output</a></span><span class="op">(</span><span class="va">sl_output</span>,</span>
<span>               trees.fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>               cells.fill <span class="op">=</span> <span class="st">"pacl"</span>,</span>
<span>               cells.fill.palette <span class="op">=</span> <span class="st">"light01"</span>,</span>
<span>               cells.border <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="1-simple_case_files/figure-html/plot_pacl-1.png" width="768"></p>
</div>
<div class="section level4">
<h4 id="output-tree">Output tree<a class="anchor" aria-label="anchor" href="#output-tree"></a>
</h4>
<p>The object <code>$output$trees</code> contains output light variables
for each trees, identified by its unique id (id_trees) and their
coordinates (x, y, z). There are 4 output variables, which are
<code>e</code> (for the total energy intercepted by the tree in MJ),
<code>epot</code> (for the potential energy intercepted by the tree
without considering its neighbors in MJ, i.e. the total energy
intercepted if the tree was alone with the same crown dimensions),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>c</mi><mi>i</mi><mo>=</mo><mn>1</mn><mo>−</mo><mi>e</mi><mi>/</mi><mi>e</mi><mi>p</mi><mi>o</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">lci = 1 - e/epot</annotation></semantics></math>
(which is a light competition index, representing the real intercepted
energy compared to the potential energy it could intercept without
competition, see Beauchamp et al. 2025) and <code>punobs</code> (for the
proportion of energy intercepted by the tree that comes from
unobstructed rays, i.e. rays that have not been intercepted by any other
trees).</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sl_output</span><span class="op">$</span><span class="va">output</span><span class="op">$</span><span class="va">trees</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id_tree       x       y        z      epot          e       lci    eunobs</span></span>
<span><span class="co">#&gt; 1     116 13.4212 99.1656 10.42272 387315.14 115800.300 0.6064701 83985.216</span></span>
<span><span class="co">#&gt; 2      92 43.1255 98.0173 10.30203 253854.10  96236.706 0.6855485 81000.256</span></span>
<span><span class="co">#&gt; 3      46 72.7660 98.0420 10.30463 203115.21  56293.576 0.6715528 45459.168</span></span>
<span><span class="co">#&gt; 4     273 93.6610 98.0882 10.30949  76453.85  15399.010 0.8029645 10108.939</span></span>
<span><span class="co">#&gt; 5     176 44.9346 97.3227 10.22903 221086.99   9713.166 0.9587289  1318.271</span></span>
<span><span class="co">#&gt; 6       4 58.9521 97.9011 10.28982 103895.59  18328.933 0.7483866 14097.755</span></span></code></pre></div>
<p>The user can plot a given output variable (e.g. trees.fill = “e” or
trees.fill = “lci”) without the cells filled (cells.fill = NULL) to
observe the light interception by trees (absolute or scaled to represent
competition). Aesthetic arguments can be tweaked, such as inversing the
palette colors (trees.fill.inverse = TRUE, better to represent the
competition with viridis, where a lci = 1 indicates a trees with a very
strong light competition).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_sl_output.html">plot_sl_output</a></span><span class="op">(</span><span class="va">sl_output</span>,</span>
<span>               trees.fill <span class="op">=</span> <span class="st">"e"</span>,</span>
<span>               cells.fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="1-simple_case_files/figure-html/plot_etree-1.png" width="768"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_sl_output.html">plot_sl_output</a></span><span class="op">(</span><span class="va">sl_output</span>,</span>
<span>               trees.fill <span class="op">=</span> <span class="st">"lci"</span>,</span>
<span>               trees.fill.inverse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               cells.fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
<p><img src="1-simple_case_files/figure-html/plot_lci-1.png" width="768"></p>
</div>
</div>
<div class="section level3">
<h3 id="gather-all-the-samsaralight-outputs">Gather all the SamsaraLight outputs<a class="anchor" aria-label="anchor" href="#gather-all-the-samsaralight-outputs"></a>
</h3>
<p>Here, the user can decide to plot the light output for both trees and
cells, and even adding the species the tree is associated to
(trees.border.species = TRUE).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_sl_output.html">plot_sl_output</a></span><span class="op">(</span><span class="va">sl_output</span>,</span>
<span>               trees.border.species <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               trees.fill <span class="op">=</span> <span class="st">"lci"</span>,</span>
<span>               trees.fill.inverse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               cells.fill <span class="op">=</span> <span class="st">"pacl"</span>,</span>
<span>               cells.fill.palette <span class="op">=</span> <span class="st">"light01"</span>,</span>
<span>               cells.border <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="1-simple_case_files/figure-html/plot_light-1.png" width="768"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Natheo Beauchamp, Gauthier Ligot, Francois de Coligny, Maxime Jaunatre, Benoit Courbaud.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
